<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>Ø¬Ø¯ÙˆÙ„ Ù‚Ø§Ø¨Ù„ ÙˆÛŒØ±Ø§ÛŒØ´ Ùˆ Ø±Ù†Ú¯ÛŒ</title>
  <style>
    body {
      direction: rtl;
      font-family: Vazirmatn, sans-serif;
      text-align: center;
      background-color: #f3f3f3;
      padding-top: 30px;
    }
    table {
      border-collapse: collapse;
      margin: 20px auto;
      background: white;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
      transition: 0.3s;
    }
    td, th {
      border: 1px solid #aaa;
      padding: 10px 20px;
      text-align: center;
      min-width: 80px;
      cursor: text;
    }
    td:focus {
      outline: 2px solid #2196F3;
    }
    button {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 10px 15px;
      margin: 5px;
      cursor: pointer;
      border-radius: 5px;
      transition: 0.3s;
    }
    button:hover {
      background: #388E3C;
    }
    #colorPicker {
      margin-top: 10px;
      width: 100px;
      height: 35px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h2>ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ù‚Ø§Ø¨Ù„ ÙˆÛŒØ±Ø§ÛŒØ´ Ùˆ Ø±Ù†Ú¯ÛŒ</h2>

  <table id="myTable">
    <tr>
      <th>Ø³ØªÙˆÙ† Û±</th>
      <th>Ø³ØªÙˆÙ† Û²</th>
      <th>Ø³ØªÙˆÙ† Û³</th>
    </tr>
    <tr>
      <td contenteditable="true">Ø±Ø¯ÛŒÙ Û±</td>
      <td contenteditable="true">Ø±Ø¯ÛŒÙ Û±</td>
      <td contenteditable="true">Ø±Ø¯ÛŒÙ Û±</td>
    </tr>
  </table>

  <button onclick="addRow()">â• Ø§ÙØ²ÙˆØ¯Ù† Ø³Ø·Ø±</button>
  <button onclick="addColumn()">â• Ø§ÙØ²ÙˆØ¯Ù† Ø³ØªÙˆÙ†</button>
  <br>
  <input type="color" id="colorPicker" title="ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ Ø³Ù„ÙˆÙ„">

  <script>
    const table = document.getElementById("myTable");
    const colorPicker = document.getElementById("colorPicker");
    let selectedCell = null;

    // Ø§ÙØ²ÙˆØ¯Ù† Ø³Ø·Ø± Ø¬Ø¯ÛŒØ¯
    function addRow() {
      const columnCount = table.rows[0].cells.length;
      const newRow = table.insertRow();

      for (let i = 0; i < columnCount; i++) {
        const cell = newRow.insertCell();
        cell.textContent = `Ø³Ø·Ø± ${table.rows.length - 1}`;
        cell.contentEditable = "true";
        enableCellEvents(cell);
      }
    }

    // Ø§ÙØ²ÙˆØ¯Ù† Ø³ØªÙˆÙ† Ø¬Ø¯ÛŒØ¯
    function addColumn() {
      const headerRow = table.rows[0];
      const newColIndex = headerRow.cells.length + 1;

      const newHeaderCell = document.createElement("th");
      newHeaderCell.textContent = `Ø³ØªÙˆÙ† ${newColIndex}`;
      headerRow.appendChild(newHeaderCell);

      for (let i = 1; i < table.rows.length; i++) {
        const cell = table.rows[i].insertCell();
        cell.textContent = `Ø±Ø¯ÛŒÙ ${i}`;
        cell.contentEditable = "true";
        enableCellEvents(cell);
      }
    }

    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù‚Ø§Ø¨Ù„ÛŒØª Ø§Ù†ØªØ®Ø§Ø¨ Ùˆ ØªØºÛŒÛŒØ± Ø±Ù†Ú¯
    function enableCellEvents(cell) {
      cell.addEventListener("click", () => {
        selectedCell = cell;
      });

      cell.addEventListener("contextmenu", (e) => {
        e.preventDefault();
        selectedCell = cell;
        colorPicker.click();
      });
    }

    // Ø±Ù†Ú¯â€ŒØ¯Ù‡ÛŒ Ø¨Ù‡ Ø³Ù„ÙˆÙ„ Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡
    colorPicker.addEventListener("input", () => {
      if (selectedCell) {
        selectedCell.style.backgroundColor = colorPicker.value;
      }
    });

    // ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù‚Ø§Ø¨Ù„ÛŒØª Ø¨Ø±Ø§ÛŒ Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
    for (let i = 1; i < table.rows.length; i++) {
      for (let j = 0; j < table.rows[i].cells.length; j++) {
        enableCellEvents(table.rows[i].cells[j]);
      }
    }
  </script>

</body>
</html>

